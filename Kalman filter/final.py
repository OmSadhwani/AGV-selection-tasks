import numpy as np
from matplotlib import pyplot as plt


class KalmanFilter(object):
    def __init__(self, t, std_acc, std_meas):
        self.dt = t

        self.std_acc = std_acc
        self.F = np.matrix([[1,0, self.dt,0,0,0],
                            [0, 1,0,self.dt,0,0],
                            [0,0,1,0,self.dt,0],
                            [0,0,0,1,0,self.dt],
                            [0,0,0,0,1,0],
                            [0,0,0,0,0,1]
                            ])

        self.H = np.matrix([[1,0,0,0,0,0],
                            [0,1,0,0,0,0],
                            [0,0,1,0,0,0],
                            [0,0,0,1,0,0],
                            [0,0,0,0,0,0],
                            [0,0,0,0,0,0]])

        self.Q = np.matrix([[(self.dt ** 4) / 4, (self.dt ** 3) / 2, (self.dt ** 2) * 0.5, 0, 0, 0],
                            [(self.dt ** 3) / 2, (self.dt ** 2), (self.dt), 0, 0, 0],
                            [(self.dt ** 2) * 0.5, (self.dt), 1, 0, 0, 0],
                            [0, 0, 0, (self.dt ** 4) / 4, (self.dt ** 3) / 2, (self.dt ** 2) * 0.5],
                            [0, 0, 0, (self.dt ** 3) / 2, (self.dt ** 2), (self.dt)],
                            [0, 0, 0, (self.dt ** 2) * 0.5, (self.dt), 1]]) * self.std_acc ** 2

        self.R=np.eye(self.F.shape[1])*std_meas

        self.P = np.eye(self.F.shape[1])*600
        self.x = np.matrix([[372.99815102559614],[0],[0],[0],[0],[0]])

    def predict(self):

        self.x = np.dot(self.F, self.x)

        self.P = np.dot(np.dot(self.F, self.P), self.F.T) + self.Q


    def update(self, z):

        S = np.dot(self.H, np.dot(self.P, self.H.T)) + self.R

        K = np.dot(np.dot(self.P, self.H.T), np.linalg.inv(S))
        self.x = (self.x + np.dot(K, (z - np.dot(self.H, self.x))))
        I = np.eye(self.H.shape[1])
        self.P = (I - (K * self.H)) * self.P



def main():
    dt = 1

    trackx= [372.99815102559614,
             368.1893157,
369.5079317,
377.0563003,
365.6874851,
370.0554475,
370.4990716,
368.1216054,
364.0724165,
359.5012925,
351.7177371,
356.2711206,
355.5428017,
350.9476774,
352.9563289,
343.401664,
344.0926383,
341.4883802,
336.1901954,
334.7768043,
332.3450809,
332.0656842,
328.9660415,
325.2571574,
317.6562451,
316.8770452,
307.26168,
304.5984025,
300.9226209,
296.9689419,
291.1969062,
287.9513841,
279.918069,
285.1034081,
275.1683482,
270.9234025,
272.4993626,
265.8400733,
259.2150917,
250.9116891,
247.8673496,
242.1428443,
239.8320121,
234.0875591,
228.6790747,
222.8355556,
218.0329411,
211.8553811,
205.5609745,
202.394343,
196.9223031,
192.4209145,
186.8362803,
183.6460102,
176.4639708,
172.4998812,
167.8100042,
164.3933504,
159.8693418,
152.356379,
147.276244,
141.006641,
141.0656255,
133.3123895,
126.6395324,
122.2109982,
117.7071011,
114.5990543,
107.232122,
103.8593221,
98.1378049,
93.58328273,
88.56315887,
83.93038239,
78.63024376,
72.86607531,
70.1975968,
64.43269093,
58.56483351,
54.15905805,
49.72326062,
44.5374357,
39.11285724,
34.49727948,
30.35662522,
24.53380026,
19.97074919,
14.69062748,
10.00843224,
5.062465441,
-0.221216047,
-4.766014513,
-9.498279436,
-14.38640383,
-19.55667583,
-24.02079433,
-29.04845889,
-33.82293239,
-38.72068865,
-43.99899683,
-47.98304619,
-54.89912946,
-58.43383208,
-62.28731581,
-67.73983699,
-73.92553936,
-77.74909512,
-81.42777337,
-89.01049289,
-91.94398216,
-97.72390033,
-101.8623612,
-108.0998844,
-112.3885491,
-117.4322032,
-121.5636161,
-127.2118377,
-132.9743472,
-137.0358052,
-142.6365,
-148.4532839,
-152.4434408,
-158.9042217,
-160.9146579,
-169.1879024,
-172.5570135,
-176.98322,
-182.7880612,
-185.6879962,
-194.2192954,
-195.8382888,
-201.9448161,
-209.0627541,
-210.8886899,
-217.7667443,
-220.4406113,
-232.9251649,
-231.7968997,
-237.0845879,
-240.0510487,
-249.0170537,
-249.5874602,
-258.3802346,
-259.6328364,
-267.3617749,
-273.9891488,
-271.7209248,
-279.3722318,
-286.6520786,
-297.596332,
-294.7349519,
-294.6043812,
-298.2455192,
-305.7466604,
-314.7808219,
-318.3606643,
-319.0343536,
-323.9531447,
-322.3789615,
-327.3489218,
-330.1834544,
-335.43475,
-342.826495,
-342.4175424,
-346.7271159,
-346.8498505,
-347.709991,
-354.8007238,
-345.7309677,
-358.2102908,
-356.2632482,
-356.8992009,
-366.8915977,
-369.3032498,
-363.4067742,
-364.950061,
-372.0466721,
-365.0741454,
-367.3141341,
-364.3033403,
-370.4031283,
-365.9413667,
-368.1184079,
-362.6222061,
-363.6898374,
-369.7111505,
-373.4346458,
-364.2594367,
-366.0645913,
-362.2604747,
-362.7838924,
-362.0708779,
-354.3938974,
-357.2274927,
-356.5093895,
-350.5845825,
-349.9831773,
-342.3657535,
-340.7905371,
-341.3753771,
-331.7990397,
-328.2146436,
-326.0062626,
-329.0413078,
-318.6332439,
-317.8565804,
-311.7837974,
-304.7470388,
-301.3499027,
-303.8358799,
-294.0200437,
-287.86205,
-286.6563137,
-278.921229,
-282.2815752,
-274.0135763,
-266.534252,
-266.7979733,
-258.0905756,
-255.0384836,
-249.1524045,
-241.8909858,
-237.7533532,
-233.706236,
-226.4466432,
-221.1336206,
-219.9977228,
-212.8023378,
-207.3102886,
-201.4993965,
-201.7202677,
-196.6531479,
-188.2773239,
-182.3608641,
-179.4289414,
-171.1820235,
-167.2863405,
-165.6554637,
-159.6315105,
-151.2538445,
-148.6018297,
-145.3088621,
-139.4582469,
-137.2965011,
-127.5006644,
-125.158402,
-119.8948408,
-114.2713999,
-110.2649901,
-103.8890018,
-99.03621753,
-93.58825964,
-91.11178433,
-84.20403875,
-79.11152943,
-74.09554345,
-70.04012784,
-64.70677021,
-59.7862507,
-54.57020256,
-49.36466028,
-45.00662907,
-39.76850922,
-35.42800653,
-30.32224728,
-25.25424799,
-20.42221153,
-15.23346677,
-10.62943695,
-5.535405907,
-0.669665893,
4.17464184,
9.03856956,
13.95310393,
18.71435787,
23.96726338,
28.85874625,
33.62881548,
38.42281087,
43.40650627,
48.27596005,
52.70430767,
57.26053269,
62.56457979,
66.91967771,
73.26022537,
78.64469148,
84.17395555,
85.46156308,
94.02666295,
98.22440618,
101.0232134,
108.2478013,
111.368285,
118.9669571,
122.4246101,
128.1896229,
133.4564394,
137.9962334,
141.3953747,
146.5236573,
153.101836,
156.35604,
159.414857,
166.4562002,
171.5818388,
177.1734123,
181.2139327,
189.4073458,
194.9383275,
195.94146,
196.9664701,
209.0910067,
207.7137057,
216.189451,
223.058129,
228.5278765,
233.5771504,
236.6150576,
243.7191966,
246.3148081,
251.1280025,
253.6283479,
258.7352468,
266.3652109,
265.5897628,
276.4058782,
273.931305,
283.0610592,
288.7177582,
295.1143089,
298.2270362,
298.795175,
308.0012073,
307.6225511,
316.1028254,
322.5108672,
320.9758571,
323.2432618,
332.4319153,
330.7364309,
342.5568255,
339.3133176,
344.2917197,
349.4033219,
348.3847493,
347.2281431,
352.7177008,
360.705469,
357.4755327,
362.8493119,
362.0335354,
367.4390278,
362.2795354,
367.2192574,
360.2430492,
367.2494757,
368.3590653,
362.3760605,
372.5467085,
]
    tracky=[3.686804471625727*10**(-6),
        6.596610613,
12.68799036,
19.79319841,
25.65474981,
32.08098393,
39.15583086,
45.15172617,
51.04920725,
57.0741933,
64.21512717,
70.67440031,
76.72984008,
80.56630244,
88.81488331,
94.22217513,
98.0691133,
105.4173325,
109.9403554,
115.959563,
119.0475008,
126.741035,
129.0223134,
136.9220328,
140.8873878,
147.1928171,
150.330704,
156.9254855,
160.7338002,
164.5227806,
168.7545794,
179.3783325,
181.63976,
179.5563287,
186.715567,
188.0988549,
195.0734527,
200.1964131,
199.9929591,
207.0972105,
206.3356737,
212.7132289,
218.4883115,
215.266563,
222.5498233,
224.2325609,
229.5977436,
231.3116497,
232.9765774,
233.2525966,
238.4780781,
236.2395358,
242.5770379,
242.5912394,
245.2091044,
244.2370937,
249.3468993,
256.1037931,
248.3454632,
259.0966529,
253.3098949,
258.4267697,
258.8087975,
266.3528317,
259.5462283,
261.8553763,
265.7137,
265.2776183,
261.0138877,
268.4869373,
271.4110827,
269.4237497,
269.1685049,
270.5179988,
271.0655949,
279.0450369,
268.6258311,
273.9163541,
277.9999886,
278.0965672,
277.9011308,
273.2510567,
276.9069442,
272.8649444,
282.9271245,
286.5893941,
276.4566802,
274.6383252,
279.9023309,
281.1558438,
280.3738136,
284.06051,
279.4206345,
280.9398669,
283.128312,
276.8615466,
274.8195833,
278.1165705,
279.5845988,
274.6659164,
276.0027296,
273.4474315,
272.4226908,
275.8830654,
274.8638072,
276.5398996,
274.2700529,
272.7807933,
277.2158297,
273.3258264,
264.2070393,
274.403862,
265.4252132,
265.5318118,
265.5021971,
262.6413698,
258.1579115,
262.1098538,
257.804366,
256.9480403,
255.6078774,
254.4727603,
253.9859681,
251.9369376,
250.139074,
244.5480636,
247.8811075,
239.7409429,
244.5436299,
241.9008004,
238.7461009,
230.933005,
234.5247806,
225.2460876,
227.3858836,
222.7721448,
217.216037,
216.8593594,
214.6903084,
215.3588747,
206.9981311,
202.4545532,
198.3250011,
195.6518392,
193.6347171,
192.8321645,
187.6016932,
185.1451558,
175.3701026,
171.7988204,
169.8610695,
166.1677703,
162.2535404,
154.6804099,
152.6617917,
146.7521849,
142.7791313,
137.1424602,
131.1888593,
128.0263938,
122.4511604,
116.5624819,
110.5541194,
105.2704057,
98.64171665,
95.12502533,
86.77685664,
81.34522484,
76.93984047,
69.27784394,
64.70860854,
57.51561139,
50.92635925,
44.3154636,
39.39817618,
33.28953895,
26.81626432,
19.71398245,
13.35832403,
6.977346173,
0.589564989,
-5.814455378,
-12.69752706,
-19.05029219,
-25.22588299,
-31.3642817,
-37.41100635,
-43.5628179,
-51.33121242,
-57.28658232,
-62.49592288,
-70.38351505,
-74.84826508,
-80.37058515,
-86.01752307,
-93.1862055,
-98.81313645,
-103.1227173,
-110.5951926,
-115.7111946,
-121.4156311,
-125.867367,
-133.18113,
-135.7622791,
-139.6702464,
-145.6377084,
-150.9452092,
-155.9836995,
-158.3174705,
-166.5362597,
-168.2094684,
-171.3503373,
-180.1440427,
-181.4979817,
-187.0732601,
-189.7920781,
-193.8488271,
-197.5772174,
-200.0076687,
-204.2448591,
-203.8077721,
-209.299086,
-214.6877556,
-215.8087237,
-213.5825317,
-222.2802106,
-220.4473038,
-227.1280039,
-233.2632954,
-237.2491167,
-238.3193507,
-240.7538485,
-239.9718626,
-244.3501619,
-239.5418489,
-245.4024597,
-249.4421473,
-252.9822903,
-249.9430274,
-257.2601956,
-256.1158551,
-261.0924243,
-259.4374299,
-258.8531219,
-262.7621615,
-262.7321339,
-268.7333808,
-264.3879553,
-266.0830295,
-267.5208899,
-270.1140124,
-269.0801221,
-269.6617594,
-276.8955339,
-272.0259311,
-278.2479823,
-271.5821321,
-274.8989647,
-279.3580276,
-281.7375563,
-278.5422491,
-279.6085629,
-277.6941151,
-276.7949628,
-280.7203022,
-280.1896444,
-284.4593271,
-276.0539479,
-279.0661739,
-280.0957627,
-275.4992678,
-280.2223986,
-281.0760905,
-284.5074497,
-280.8229144,
-281.4161045,
-275.4497543,
-276.9727948,
-278.156683,
-271.5114891,
-280.3904043,
-278.1989196,
-283.8777688,
-274.0284304,
-280.2874221,
-279.6715329,
-278.1160929,
-274.5618305,
-272.0363065,
-268.7025228,
-267.9571216,
-266.0137893,
-268.4613479,
-268.4156371,
-263.8107003,
-260.7681528,
-263.7967698,
-262.2210623,
-259.1064819,
-257.9749917,
-257.8352333,
-248.7531612,
-254.4601413,
-249.9502108,
-253.2384369,
-246.5435858,
-245.1565978,
-244.4604319,
-243.1794438,
-241.6016414,
-234.3497917,
-231.3339323,
-230.2702024,
-231.341621,
-226.052416,
-218.9430385,
-220.4955423,
-215.5161294,
-216.7442223,
-209.8444666,
-207.6777908,
-204.975555,
-201.7524354,
-201.3464687,
-195.7097855,
-190.5000152,
-186.9897753,
-183.0205483,
-180.4703881,
-173.9785012,
-168.9128264,
-167.5893405,
-159.9679119,
-154.009469,
-150.7257094,
-148.6174188,
-141.3187531,
-138.6796883,
-132.0588457,
-128.9885572,
-123.264372,
-116.149092,
-109.9962599,
-104.1701087,
-101.8235276,
-94.94186695,
-90.25105738,
-83.2287943,
-77.34861746,
-70.43132275,
-64.30597293,
-58.2069027,
-51.82825947,
-45.33381649,
-39.58482207,
-33.56014645,
-26.26200508,
-20.57904101,
-14.27329371,
-7.564212315,

]
    vx=[0,
        -0.0990697,
        - 0.298078966,
        - 0.498539844,
        - 0.69554821,
        - 0.900689698,
        - 1.1344481,
        - 1.218416853,
        - 1.488852277,
        - 1.64054755,
        - 1.876472271,
        - 1.961531181,
        - 2.237814277,
        - 2.332598916,
        - 2.382500819,
        - 2.549594656,
        - 2.669666239,
        - 3.036801666,
        - 2.900647827,
        - 3.184730617,
        - 3.364524498,
        - 3.381546486,
        - 3.802738749,
        - 3.642951227,
        - 3.792707768,
        - 3.910418586,
        - 4.079281878,
        - 4.006136192,
        - 4.490050671,
        - 4.258207575,
        - 4.451244073,
        - 4.312287065,
        - 4.438155169,
        - 4.436562031,
        - 4.753479559,
        - 4.681392212,
        - 4.606134007,
        - 4.756931444,
        - 4.757435026,
        - 4.931134575,
        - 5.017640953,
        - 4.855569368,
        - 4.925480779,
        - 5.159227507,
        - 5.108598587,
        - 5.051521459,
        - 4.768149885,
        - 5.014290514,
        - 4.964900966,
        - 5.014848761,
        - 5.108425011,
        - 5.202941259,
        - 5.233524671,
        - 5.189595926,
        - 4.939997698,
        - 4.947015579,
        - 5.17896232,
        - 5.074460621,
        - 5.030544978,
        - 5.168725426,
        - 5.155696475,
        - 5.178209709,
        - 4.824875797,
        - 5.270112997,
        - 4.698291789,
        - 5.12554983,
        - 4.818170444,
        - 5.085450739,
        - 4.733684553,
        - 4.785290194,
        - 4.938155311,
        - 4.708973467,
        - 5.044302723,
        - 4.880008173,
        - 4.873245149,
        - 4.923287982,
        - 4.922425498,
        - 4.85113552,
        - 4.945773937,
        - 4.846772921,
        - 4.910493678,
        - 5.019778357,
        - 4.857129772,
        - 4.782624769,
        - 4.872446043,
        - 4.816210114,
        - 4.810362792,
        - 4.622714667,
        - 4.92331989,
        - 4.691519945,
        - 5.488994458,
        - 4.351083966,
        - 5.044547294,
        - 4.967388146,
        - 4.79498604,
        - 5.050265253,
        - 5.006301817,
        - 4.958065811,
        - 4.894236609,
        - 4.81942398,
        - 4.930135305,
        - 4.902126459,
        - 5.097665287,
        - 4.66974228,
        - 4.746476145,
        - 4.705807093,
        - 5.111068127,
        - 4.879220982,
        - 5.208823501,
        - 5.116198659,
        - 5.009618858,
        - 5.058360562,
        - 4.965325351,
        - 5.049888626,
        - 4.93494674,
        - 5.17236476,
        - 4.957452358,
        - 5.188329576,
        - 5.031158491,
        - 4.791984433,
        - 4.938763047,
        - 4.890765077,
        - 5.175174697,
        - 4.970683594,
        - 4.76316814,
        - 4.954591038,
        - 5.087655431,
        - 5.119700858,
        - 4.915767582,
        - 4.911519709,
        - 5.173355356,
        - 5.013460924,
        - 5.010377044,
        - 4.969387315,
        - 4.941153294,
        - 4.976962368,
        - 5.05619717,
        - 4.846439972,
        - 4.901729802,
        - 4.778135301,
        - 4.636287496,
        - 4.730973285,
        - 4.802679684,
        - 4.696028964,
        - 4.849647123,
        - 4.662207623,
        - 4.407706767,
        - 4.829506816,
        - 4.719618904,
        - 4.368191987,
        - 4.482208834,
        - 4.377603953,
        - 4.435667563,
        - 4.172075062,
        - 3.995484198,
        - 3.997107113,
        - 3.980837452,
        - 3.719872481,
        - 3.617958451,
        - 3.542765045,
        - 3.457520586,
        - 3.305212095,
        - 3.314304617,
        - 3.29818412,
        - 2.971197719,
        - 2.618965289,
        - 2.686781676,
        - 2.475441322,
        - 2.350791809,
        - 2.180153751,
        - 1.944280454,
        - 1.788647921,
        - 1.716743227,
        - 1.526548868,
        - 1.296244213,
        - 1.135636614,
        - 0.955931253,
        - 0.719005811,
        - 0.482924999,
        - 0.313054102,
        - 0.121148,
        0.080159761,
        0.276960121,
        0.456799105,
        0.636865355,
        0.849564078,
        1.028796478,
        1.248824823,
        1.372402333,
        1.594671396,
        1.759914955,
        1.88905116,
        2.242322195,
        2.261201776,
        2.559462432,
        2.582945191,
        2.799723108,
        2.89035541,
        3.061050288,
        3.22728096,
        3.332579893,
        3.42092704,
        3.622690974,
        3.636184695,
        3.750690242,
        3.957741112,
        4.128841167,
        4.055007386,
        4.185534107,
        4.197118585,
        4.18059935,
        4.086687868,
        4.424988607,
        4.342036497,
        4.908434867,
        4.551758777,
        4.585405563,
        4.663005892,
        4.654008819,
        4.964270928,
        4.730509343,
        4.82592096,
        4.895322226,
        5.101430524,
        4.908131812,
        5.022497371,
        5.296605643,
        4.765395707,
        4.990526634,
        5.126099862,
        4.993068437,
        4.9641086,
        5.001405517,
        5.028118088,
        5.069811067,
        5.210286325,
        4.942927908,
        5.003949628,
        5.093885625,
        4.945135362,
        5.196999319,
        5.2128179,
        5.081123072,
        4.786916062,
        4.971347985,
        5.058067248,
        4.973325566,
        4.727409215,
        5.014492405,
        4.899124092,
        5.01141564,
        5.00696765,
        4.746564232,
        4.82222584,
        4.877008614,
        4.903411472,
        5.031253196,
        4.877874015,
        5.155961344,
        4.957478308,
        4.771522472,
        5.106043571,
        5.229067372,
        5.139183362,
        5.119722068,
        4.823706223,
        4.876149489,
        4.964470148,
        4.77690058,
        4.746778461,
        4.575726429,
        4.658823458,
        4.863551269,
        4.867220088,
        4.981505386,
        4.970686382,
        4.859259416,
        4.803881886,
        4.713995185,
        4.814745071,
        5.116091229,
        4.88401747,
        4.720546638,
        4.926599691,
        5.024060028,
        4.77182663,
        5.035330194,
        4.985031162,
        5.011535257,
        4.825429659,
        5.083214186,
        4.887252185,
        4.890843959,
        4.957879881,
        5.148048306,
        4.968126255,
        5.037947265,
        5.080407963,
        5.076060891,
        5.214770442,
        5.076440292,
        5.27116668,
        4.78605551,
        5.057391612,
        4.726345762,
        4.759574954,
        5.156522677,
        4.962015322,
        5.112464499,
        4.876194267,
        4.795303906,
        5.214002006,
        5.132905314,
        4.947385688,
        4.999221843,
        4.963876241,
        4.881057735,
        4.898263604,
        4.992851418,
        4.760941784,
        4.808452118,
        4.658343561,
        4.915819529,
        4.834263555,
        4.940366394,
        4.595988878,
        4.696205643,
        4.560559891,
        4.622506609,
        4.452863776,
        4.595767672,
        4.272600815,
        4.129960612,
        4.144796483,
        4.113826191,
        3.89235296,
        3.797204864,
        3.789041972,
        3.630051325,
        3.651831504,
        3.356196159,
        3.294101207,
        3.180980911,
        3.0710512,
        2.953186499,
        2.869008244,
        2.662170866,
        2.521359106,
        2.345930758,
        2.183269138,
        1.991462874,
        1.755191684,
        1.666653762,
        1.484491257,
        1.246379572,
        1.084414968,
        0.902986037,
        0.73247301,
        0.530701946,
        0.325604234,
        ]
    vy=[0,
        6.361599148,
        6.396538352,
        6.339846883,
        6.348781312,
        6.373027003,
        6.64013785,
        5.759283643,
        6.242348057,
        6.080235126,
        6.150399802,
        6.341383464,
        5.769883882,
        6.007404993,
        5.949581361,
        5.815399705,
        5.44650564,
        5.643404986,
        5.603151898,
        5.640802541,
        5.166301915,
        5.330611336,
        4.897408033,
        5.369895841,
        4.919735177,
        4.923003633,
        4.48940087,
        4.889399722,
        4.141191906,
        4.330490222,
        4.483035911,
        4.237347525,
        4.275747476,
        4.178297723,
        3.972640236,
        3.852814746,
        3.698941153,
        3.570144866,
        3.594159119,
        3.529315591,
        3.211576194,
        3.250241934,
        3.263195414,
        3.181944517,
        3.011557528,
        2.985609494,
        2.795967619,
        2.635732089,
        2.609743515,
        2.572063406,
        2.352633064,
        2.407682832,
        2.362217418,
        2.129042821,
        2.113593685,
        2.034303484,
        1.94730651,
        1.890677936,
        1.786631244,
        1.777476223,
        1.598878234,
        1.591795031,
        1.593420978,
        1.422731975,
        1.497002465,
        1.384405073,
        1.35153176,
        1.245185067,
        1.142906998,
        1.133100442,
        1.001921035,
        1.032182558,
        0.922122385,
        0.920629263,
        0.829169263,
        0.787234134,
        0.707809851,
        0.672289129,
        0.62741382,
        0.576221342,
        0.533821724,
        0.492872636,
        0.410820063,
        0.355281662,
        0.315870641,
        0.278992998,
        0.224133862,
        0.167871558,
        0.127665872,
        0.074196641,
        0.002207973,
        0.002315312,
        - 0.066860908,
        - 0.124842673,
        - 0.168752358,
        - 0.223130925,
        - 0.269497075,
        - 0.312745393,
        - 0.382899723,
        - 0.429555019,
        - 0.465267712,
        - 0.496461292,
        - 0.567558085,
        - 0.601872562,
        - 0.692939146,
        - 0.701364039,
        - 0.77855046,
        - 0.858500552,
        - 0.83525058,
        - 0.932622794,
        - 0.98255461,
        - 1.054518806,
        - 1.102056234,
        - 1.122852021,
        - 1.291045312,
        - 1.334845472,
        - 1.359425611,
        - 1.40036043,
        - 1.438931346,
        - 1.599437513,
        - 1.581101504,
        - 1.610983652,
        - 1.728368037,
        - 1.741160986,
        - 1.920183556,
        - 1.972370038,
        - 1.999716222,
        - 2.126362151,
        - 2.199340627,
        - 2.27473163,
        - 2.312662151,
        - 2.465397577,
        - 2.569689608,
        - 2.607179652,
        - 2.723023946,
        - 2.827235037,
        - 2.821666945,
        - 3.04759152,
        - 2.898017057,
        - 3.255533825,
        - 3.365229085,
        - 3.458572966,
        - 3.373891747,
        - 3.387803486,
        - 3.6303508,
        - 3.674410022,
        - 3.843101369,
        - 3.991130746,
        - 4.042233491,
        - 3.981519654,
        - 4.140734216,
        - 4.775482521,
        - 4.503143363,
        - 4.577461694,
        - 4.812837081,
        - 4.819867286,
        - 4.880884299,
        - 5.100843928,
        - 5.00766145,
        - 5.203449571,
        - 5.160236207,
        - 5.075952836,
        - 5.870989568,
        - 5.687047092,
        - 5.81401263,
        - 5.857525824,
        - 5.879244535,
        - 6.016080303,
        - 6.172932215,
        - 5.928932704,
        - 6.069809304,
        - 5.951510547,
        - 6.561921776,
        - 6.093844045,
        - 6.10664136,
        - 6.62588278,
        - 6.191939319,
        - 6.382689746,
        - 6.662037191,
        - 6.129132157,
        - 6.454009395,
        - 6.576624518,
        - 6.79227409,
        - 6.77372165,
        - 6.566080511,
        - 6.488247115,
        - 6.529310534,
        - 5.753954197,
        - 6.573481205,
        - 6.162914448,
        - 5.769342487,
        - 6.154123617,
        - 6.129528791,
        - 5.71381915,
        - 6.073879569,
        - 5.625500252,
        - 5.885804436,
        - 5.315712023,
        - 5.536379597,
        - 5.530073347,
        - 5.407443689,
        - 5.385390986,
        - 5.369837478,
        - 4.973954828,
        - 5.113408907,
        - 5.23147605,
        - 4.620502784,
        - 4.576335776,
        - 4.691580445,
        - 4.459843645,
        - 4.519257126,
        - 4.442097915,
        - 4.14420753,
        - 4.145995653,
        - 4.057645262,
        - 3.794281105,
        - 3.647357915,
        - 3.696923393,
        - 3.555088559,
        - 3.701672338,
        - 3.52177961,
        - 3.219970122,
        - 3.132544659,
        - 2.980591038,
        - 2.987158686,
        - 2.821736626,
        - 2.793452676,
        - 2.821973684,
        - 2.658526499,
        - 2.358466318,
        - 2.392558407,
        - 2.362153014,
        - 2.235143479,
        - 2.235898753,
        - 2.070304836,
        - 2.020741166,
        - 2.103497667,
        - 1.910809789,
        - 1.782272337,
        - 1.755183415,
        - 1.682549081,
        - 1.610897271,
        - 1.572691432,
        - 1.527251323,
        - 1.471855797,
        - 1.376394238,
        - 1.289305811,
        - 1.246931511,
        - 1.159104206,
        - 1.126825926,
        - 1.067203634,
        - 1.039951414,
        - 0.986318154,
        - 0.941691204,
        - 0.822109781,
        - 0.790488856,
        - 0.714361743,
        - 0.637178787,
        - 0.632473449,
        - 0.568362257,
        - 0.497379021,
        - 0.481510525,
        - 0.433058206,
        - 0.351722231,
        - 0.331655632,
        - 0.281286306,
        - 0.228881579,
        - 0.182499576,
        - 0.128219732,
        - 0.081852073,
        - 0.033251668,
        0.017296289,
        0.063864889,
        0.118225947,
        0.169086277,
        0.217175095,
        0.256392288,
        0.305774853,
        0.351719269,
        0.405732025,
        0.475896075,
        0.514624846,
        0.546120526,
        0.585852473,
        0.649926721,
        0.751400304,
        0.810045814,
        0.76770462,
        0.885138005,
        0.941821776,
        1.013745086,
        1.025387163,
        1.039372111,
        1.158637559,
        1.199443369,
        1.288875399,
        1.401988392,
        1.36438115,
        1.471872406,
        1.47331517,
        1.628696189,
        1.755845222,
        1.779063356,
        1.809512069,
        1.955145363,
        1.950371024,
        2.017610837,
        2.152117371,
        2.032640153,
        2.297990677,
        2.36355919,
        2.410131645,
        2.506847029,
        2.623910057,
        2.623926292,
        2.812764027,
        2.892023351,
        2.926877163,
        3.201037231,
        3.139817773,
        3.257627239,
        3.453357246,
        3.39473979,
        3.438433472,
        3.820299118,
        3.879826698,
        3.767241691,
        3.958627505,
        4.018036493,
        4.08748856,
        4.22846792,
        4.1610025,
        4.354333549,
        4.626627227,
        4.552980427,
        4.78038793,
        4.827927909,
        5.132107326,
        5.188984893,
        5.067161291,
        5.320625726,
        5.59671349,
        5.498497915,
        5.351324536,
        5.616686887,
        5.594903119,
        6.037909616,
        6.032575227,
        5.925330937,
        5.648311956,
        6.138723026,
        6.102388723,
        6.233575578,
        6.231418808,
        6.37033233,
        6.423988609,
        6.327364362,
        6.402460457,
        6.544884034,
        6.003952519,
        ]
    std_acc = 5
    std_meas = 10050

    kf = KalmanFilter(dt, std_acc, std_meas)

    estimatesx=[]
    estimatesy=[]
    measurementsx = []
    measurementsy = []

    kf.predict()
    print(kf.P)
    for xx,y,u,w in zip(trackx,tracky,vx,vy):

        z=np.matrix([[xx],[y],[u],[w],[0],[0]])


        measurementsx.append(z[0][0])
        measurementsy.append(z[1][0])


        kf.update(z)

        estimatesx.append(kf.x[0][0])
        estimatesy.append(kf.x[1][0])
        print ("the estimated positon is : ")
        print (kf.x[0][0],kf.x[1][0])
        print ("the uncertainity matrix is: ")
        print (kf.P)
        kf.predict()
    fig = plt.figure()
    fig.suptitle('Example of Kalman filter for tracking a moving object in 1-D', fontsize=20)




    arrx=np.array(estimatesx)
    arry=np.array(estimatesy)
    arrx=arrx.reshape(-1,)

    arry=arry.reshape(-1,)


    mrrx=np.array(measurementsx)
    mrry=np.array(measurementsy)
    mrrx=mrrx.reshape(-1,)
    mrry=mrry.reshape(-1,)
    plt.plot(mrrx, mrry, color='r', linewidth=1)
    plt.plot(arrx, arry, color='g', linewidth=1)

    plt.xlabel('x', fontsize=20)
    plt.ylabel('y', fontsize=20)

    plt.show()


if __name__ == '__main__':
    main()